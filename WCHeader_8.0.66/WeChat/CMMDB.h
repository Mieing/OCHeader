@class NewContactDB, MMDBMigrationInfos, NSArray, NSRecursiveLock, WCTDatabase, WCTTable, OpLogDB, WCDBSharedLockCenter, MMTimer;

@interface CMMDB : NSObject {
    NSRecursiveLock *m_lockMMDB;
    MMTimer *m_backupTimer;
    MMDBMigrationInfos *m_migrationInfos;
}

@property (retain) WCTDatabase *m_mmdb;
@property (retain) NSArray *m_messages;
@property (retain) WCTDatabase *m_brandMsgDB;
@property (retain) WCTDatabase *m_finderMsgDB;
@property (retain) WCTDatabase *m_chatbotMsgDB;
@property (retain) WCTDatabase *m_gamelifeMsgDB;
@property (retain) WCTDatabase *m_brandFansMsgDB;
@property (retain) WCTDatabase *m_w1wPersonalMsgDB;
@property (retain) WCTTable *m_tableContact;
@property (retain) WCTTable *m_tableContactExt;
@property (retain) WCTTable *m_tableContactMeta;
@property (retain) WCTTable *m_tableQQContact;
@property (retain) WCTTable *m_tableRevokeMsg;
@property (retain) WCTTable *m_tableSecMsg;
@property (retain) WCTTable *m_tableMessageBizExt;
@property (retain) WCTTable *m_tableMessageOfAppExt;
@property (retain) WCTTable *m_tableMassSendContact;
@property (retain) WCTTable *m_tableRoomHistory;
@property (retain) WCTTable *m_tableVoIPCancelMsg;
@property (readonly, nonatomic) WCDBSharedLockCenter *lockCenter;
@property (retain, nonatomic) OpLogDB *m_oplogWcdb;
@property unsigned long long state;
@property (retain) NewContactDB *m_contactDB;

+ (BOOL)isSpecialUserNames:(id)a0;
+ (id)messageDBPathWithDocDir:(id)a0 userName:(id)a1 index:(int)a2;
+ (id)brandMsgDBPathWithDocDir:(id)a0 userName:(id)a1;
+ (id)bypMsgDBPathWithDocDir:(id)a0 userName:(id)a1 path:(id)a2;
+ (id)dbPathWithDocDir:(id)a0 userName:(id)a1;
+ (id)messageTableName:(id)a0;
+ (id)messageExtTableName:(id)a0;
+ (id)helloMessageTableName:(id)a0;
+ (id)md5StringFromUserName:(id)a0;
+ (BOOL)tableShouldBeBackedUp:(id)a0;

- (void)SetupOplogDBWithDocDir:(id)a0 userName:(id)a1;
- (void)CloseOplogDB;
- (id)oplogDBDirWithDocDir:(id)a0 userName:(id)a1;
- (BOOL)InsertOplog:(id)a0;
- (id)GetOplogsAfterOplogId:(unsigned int)a0 limit:(int)a1;
- (BOOL)DeleteOplog:(unsigned int)a0;
- (void)tryMigrate;
- (void)asyncMigrate:(id)a0;
- (void)stepMigrate:(id)a0;
- (void)startMigrate:(id)a0;
- (void)startMigrateBrand:(id)a0;
- (void)autoMigrateBrand:(id)a0;
- (void)lazyCreateBrand:(id)a0;
- (void)startMigrateMessage:(id)a0;
- (void)autoMigrateMessage:(id)a0 atIndex:(unsigned int)a1;
- (void)lazyCreateMessage:(id)a0 atIndex:(int)a1;
- (void)lazyVacuum:(id)a0;
- (void)finishMigration;
- (unsigned long long)getTableLocation:(id)a0;
- (id)getTargetingDatabaseWithUserName:(id)a0;
- (id)getTargetingDatabaseWithUserName:(id)a0 excludingMMDB:(BOOL)a1;
- (void)tryFixExtMsgTable;
- (void)checkMMDBMigrateAllFinish:(id)a0;
- (BOOL)hasEnoughFreeSpaceToMigrate;
- (struct optional<bool> { union { char x0; BOOL x1; } x0; BOOL x1; })lazyCreateBrandTable:(id)a0;
- (int)indexOfDatabaseForMD5UserName:(id)a0;
- (int)indexOfDatabaseForUserName:(id)a0;
- (struct optional<bool> { union { char x0; BOOL x1; } x0; BOOL x1; })lazyCreateMessageTable:(id)a0;
- (struct optional<bool> { union { char x0; BOOL x1; } x0; BOOL x1; })shouldCreateTable:(id)a0 inDatabase:(id)a1;
- (id)getOrCreateMigrationInfos:(id)a0;
- (void)markMigrationAsStarted:(unsigned long long)a0;
- (void)checkMigrationNoFinish:(unsigned long long)a0;
- (void)markMigrationAsFinished:(unsigned long long)a0 migrationStatus:(id)a1;
- (double)migrationSpendTime;
- (BOOL)canSkipMigration:(unsigned long long)a0;
- (id)getMMDBMigrationInfo:(unsigned long long)a0;
- (id)migrationInfoPath;
- (BOOL)InsertVoIPCancelMessage:(id)a0;
- (BOOL)IsVoIPCancelMsgExistByRoomID:(unsigned long long)a0 isFromNewSync:(BOOL *)a1;
- (BOOL)IsVoIPCancelMsgExistByRoomID:(unsigned long long)a0;
- (id)GetRoomHistoryByChatName:(id)a0 historyId:(unsigned long long)a1;
- (BOOL)InsertOrUpdateRoomHistoryMsg:(id)a0 historyId:(unsigned long long)a1 svrId:(long long)a2;
- (id)GetSecMsgBySvrId:(long long)a0;
- (BOOL)InsertSecMessage:(id)a0;
- (unsigned int)GetSecMessageCount;
- (void)RemoveSecMessageById:(long long)a0;
- (BOOL)RemoveOldSecMessagesBefore:(unsigned int)a0;
- (BOOL)InsertRevokeMessage:(id)a0;
- (id)GetRevokeMsgBySvrId:(long long)a0;
- (BOOL)RemoveOldRevokeMessagesBefore:(unsigned int)a0;
- (unsigned int)InsertHelloMessage:(id)a0 withChatName:(id)a1 onProperty:(const void *)a2;
- (unsigned int)GetMaxCreateTimeInHelloMessage:(id)a0;
- (id)GetHelloMessageByChatName:(id)a0 onProperty:(const void *)a1 where:(const void *)a2 order:(const void *)a3;
- (id)GetHelloMessagesByChatName:(id)a0 onProperty:(const void *)a1 where:(const void *)a2 order:(const void *)a3 limit:(int)a4;
- (id)GetHelloMessagesByChatName:(id)a0 onProperty:(const void *)a1 where:(const void *)a2 order:(const void *)a3 groupBy:(const void *)a4 limit:(int)a5;
- (BOOL)DeleteAllHelloMessageByChatName:(id)a0 helloUser:(id)a1;
- (BOOL)UpdateHelloMessage:(id)a0 byChatName:(id)a1 onProperty:(const void *)a2 where:(const void *)a3;
- (unsigned int)GetHelloMessageCountByChatName:(id)a0 withProperty:(const void *)a1 Where:(const void *)a2;
- (BOOL)IsMessageExistWithChatName:(id)a0 localId:(unsigned int)a1;
- (unsigned int)InsertMessage:(id)a0 withChatName:(id)a1 onProperty:(const void *)a2;
- (unsigned int)replaceMessage:(id)a0 withChatName:(id)a1 onProperty:(const void *)a2;
- (id)InsertBackupMessages:(id)a0 withChatName:(id)a1 onProperty:(const void *)a2;
- (unsigned int)GetMaxCreateTimeInMessage:(id)a0;
- (unsigned int)GetMinCreateTimeInMessage:(id)a0;
- (unsigned int)GetMinCreateTimeInMessage:(id)a0 where:(const void *)a1;
- (id)GetMessageByChatName:(id)a0 OnProperty:(const void *)a1 where:(const void *)a2;
- (id)GetMessagesByChatName:(id)a0 onProperty:(const void *)a1 where:(const void *)a2 order:(const void *)a3 limit:(int)a4;
- (id)GetMessagesByChatName:(id)a0 onProperty:(const void *)a1 where:(const void *)a2 order:(const void *)a3 limit:(int)a4 hasError:(BOOL *)a5;
- (unsigned int)GetChatSqliteSeq:(id)a0;
- (BOOL)UpdateMessageByChatName:(id)a0 localId:(unsigned int)a1 withDBMessage:(id)a2 OnProperty:(const void *)a3;
- (BOOL)UpdateMessageByChatName:(id)a0 OnPropertys:(const void *)a1 toValues:(id)a2 where:(const void *)a3;
- (BOOL)UpdateMessageByChatName:(id)a0 OnPropertys:(const void *)a1 toValues:(id)a2 where:(const void *)a3 limit:(int)a4;
- (BOOL)UpdateMessageStatus:(unsigned int)a0 byChatName:(id)a1 localId:(unsigned int)a2;
- (BOOL)DeleteMessageByChatName:(id)a0 localId:(unsigned int)a1;
- (unsigned int)GetMessageCountByChatName:(id)a0 where:(const void *)a1;
- (id)GetMinMessageLocalIdByChatName:(id)a0 where:(const void *)a1 groupBy:(const void *)a2;
- (BOOL)IsMessageExtExistWithChatName:(id)a0 localId:(unsigned int)a1;
- (BOOL)InsertMessageExt:(id)a0 withChatName:(id)a1 onProperty:(const void *)a2;
- (BOOL)InsertBackupMessageExts:(id)a0 withChatName:(id)a1 onProperty:(const void *)a2;
- (id)GetMsgSourceInMessageExt:(id)a0 localId:(unsigned int)a1;
- (id)GetMsgSourceInMessageExtWithTable:(id)a0 chatName:(id)a1 localId:(unsigned int)a2;
- (id)GetMessageExtyChatName:(id)a0 OnProperty:(const void *)a1 where:(const void *)a2;
- (id)GetMsgExtInMessageExtWithTable:(id)a0 chatName:(id)a1 localId:(unsigned int)a2;
- (BOOL)UpdateMessageExtSource:(id)a0 byChatName:(id)a1 localId:(unsigned int)a2;
- (BOOL)UpdateMessageExtFlag:(unsigned int)a0 byChatName:(id)a1 localId:(unsigned int)a2;
- (BOOL)DeleteMessageExtByChatName:(id)a0 localId:(unsigned int)a1;
- (BOOL)isNewWCPayBizExtExistWithChatname:(id)a0 localId:(unsigned int)a1 type:(unsigned int)a2;
- (BOOL)insertWCPayMessageBizExt:(id)a0 onProperty:(const void *)a1 type:(unsigned int)a2;
- (id)getWCPayMessageBizExtArrayOnProperty:(const void *)a0 where:(const void *)a1 OnType:(unsigned int)a2;
- (BOOL)UpdateWCPayMessageBizStatus:(unsigned int)a0 byChatName:(id)a1 byMsgLocalId:(unsigned int)a2 bizType:(unsigned int)a3;
- (BOOL)deleteNewWCPayBizExtMsg:(const void *)a0 OnType:(unsigned int)a1;
- (BOOL)deleteWCPayMessageBizExtWithChatname:(id)a0 OnType:(unsigned int)a1;
- (BOOL)deleteWCPayMessageBizExtWithChatname:(id)a0 bizId:(id)a1 onType:(unsigned int)a2;
- (unsigned int)GetCountOfNewWCPayBizExtOnDistinctProperty:(const void *)a0 Where:(const void *)a1 bizType:(unsigned int)a2;
- (BOOL)isWCPayMessageBizExtExistWithChatname:(id)a0 localId:(unsigned int)a1;
- (BOOL)insertWCPayMessageBizExt:(id)a0 onProperty:(const void *)a1;
- (id)getWCPayMessageBizExtArrayOnProperty:(const void *)a0 where:(const void *)a1;
- (BOOL)deleteWCPayMessageBizExtWithChatname:(id)a0;
- (BOOL)checkSqliteMasterExistFor:(id)a0;
- (BOOL)insertAppMessageExt:(id)a0 onProperty:(const void *)a1;
- (BOOL)isAppMessageExtWithChatName:(id)a0 localId:(unsigned int)a1;
- (BOOL)deleteAppMessageExtWithChatname:(id)a0;
- (BOOL)deleteAppMessageExtWithChatname:(id)a0 localId:(unsigned int)a1;
- (id)getAppMessageExtOnProperty:(const void *)a0 where:(const void *)a1;
- (id)GetContactByUserName:(id)a0 property:(const void *)a1;
- (id)GetContactsWhere:(const void *)a0 onProperty:(const void *)a1 getError:(id *)a2;
- (BOOL)getAllUserName:(id)a0;
- (BOOL)getAllRemarkList:(id)a0 listType:(unsigned int)a1;
- (BOOL)DeleteContactByUserName:(id)a0;
- (BOOL)IsContactExtExist:(id)a0;
- (id)GetContactExtByUserName:(id)a0 property:(const void *)a1;
- (BOOL)DeleteContactExtByUserName:(id)a0;
- (BOOL)DeleteContactAndExtByUserNames:(id)a0;
- (id)ContactTableName;
- (id)ContactExtTableName;
- (unsigned int)getContactCount;
- (id)GetContactAndExtWithContactProperty:(const void *)a0 contactExtProperty:(const void *)a1 fromTables:(id)a2 where:(const void *)a3 getError:(id *)a4 limit:(int)a5;
- (unsigned int)GetLastUpdateTimeOfUser:(id)a0;
- (unsigned int)GetFriendMetaFlag:(id)a0;
- (void)tryConfigCompressionForBrand:(id)a0;
- (void)tryConfigCompressionForMMDB:(id)a0;
- (void)configAutoCompressionIfNeed:(id)a0 usingNewDict:(BOOL)a1;
- (id)getCompressedKey:(int)a0 usingNewDict:(BOOL)a1;
- (BOOL)isCleanUpFinished;
- (void)continueCleanUp;
- (void)cleanOneTable:(id)a0;
- (id)GetAllMassSendContact;
- (id)init;
- (void)dealloc;
- (void)InitMMDB:(id)a0 UsrName:(id)a1 NewUser:(BOOL *)a2;
- (void)Close;
- (id)dbPath;
- (id)dbPaths;
- (void)closeDBBeforeInit;
- (void)clearTables;
- (void)createTables;
- (void)createContactTable;
- (void)createMessagesTable;
- (void)createVoIPTable;
- (void)createEmoticonTable;
- (void)createOtherTable;
- (id)internalCreateTable:(id)a0 tableClass:(Class)a1;
- (BOOL)runTransaction:(id /* block */)a0 forMessageOfUser:(id)a1;
- (BOOL)runTransaction:(id /* block */)a0 ifExistMessageOfUser:(id)a1;
- (BOOL)CreateMessageTable:(id)a0;
- (id)GetMessageTable:(id)a0;
- (void)DropMessageTable:(id)a0;
- (BOOL)CreateMessageExtTable:(id)a0;
- (id)GetMessageExtTable:(id)a0;
- (void)DropMessageExtTable:(id)a0;
- (BOOL)runTransaction:(id /* block */)a0 forHelloMessageOfUser:(id)a1;
- (BOOL)CreateHelloMessageTable:(id)a0;
- (id)GetHelloMessageTable:(id)a0;
- (id)GetNewWCPayBizExtTable:(unsigned int)a0;
- (void)CreateNewWCPayBizExtTable:(unsigned int)a0;
- (void)CreateWCPayMessageBizExtTable;
- (void)CreateAppMessageExtTable;
- (void).cxx_destruct;

@end
